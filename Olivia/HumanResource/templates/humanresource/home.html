{% extends "base.html" %}
{% load static %}

{% block title %}Human Resource - Olivia Portal{% endblock %}

{% block extra_css %}
<!-- Department Specific CSS -->
<link href="{% static 'humanresource/css/humanresource.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container-fluid px-4 py-4">
  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h3 mb-0 text-dark fw-bold">
        <a href="{% url 'humanresource_home' %}" class="text-decoration-none text-dark hover-primary">
          <i class="fas fa-users text-primary me-2"></i>
          Human Resource
        </a>
      </h1>
      <p class="text-muted mb-0 small">Manage staff, leaves, petty cash, and HR operations</p>
    </div>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item"><a href="{% url 'dashboard' %}" class="text-decoration-none">Dashboard</a></li>
        <li class="breadcrumb-item active">Human Resource</li>
      </ol>
    </nav>
  </div>

  <!-- Modern Tabs Navigation -->
  {% include 'includes/app_tabs.html' with tabs=HR_TABS %}

  <!-- Page Content -->
  {% block hr_content %}
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="card shadow-sm border-0 rounded-3">
        <div class="card-header bg-white border-0 py-3">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0 fw-semibold">
              <i class="fas fa-wallet text-success me-2"></i>
              Current Balance
            </h5>
            <button class="btn btn-primary btn-sm rounded-pill px-3" data-bs-toggle="modal" data-bs-target="#updateBalanceModal">
              <i class="fas fa-sync-alt me-2"></i> Update Balance
            </button>
          </div>
        </div>
        <div class="card-body p-4">
          {% if project_balances %}
          <div class="row g-4">
            {% for pb in project_balances %}
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100" style="background: linear-gradient(135deg, #7488e2 0%, #906eb3 100%);">
                <div class="card-body text-white p-4">
                  <h6 class="card-title fw-bold mb-3 pb-3 border-bottom border-light border-opacity-25">
                    <i class="fas fa-project-diagram me-2"></i>{{ pb.name }}
                  </h6>
                  
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="opacity-75">Opening</span>
                    <span class="fw-semibold">{{ pb.opening_balance|floatformat:2 }}</span>
                  </div>
                  <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="opacity-75">Replenishment</span>
                    <span class="fw-semibold">{{ pb.replenishment|floatformat:2 }}</span>
                  </div>
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="opacity-75">Submitted</span>
                    <span class="fw-semibold">{{ pb.submitted_nonblank|floatformat:2 }}</span>
                  </div>
                  
                  <div class="pt-3 border-top border-light border-opacity-25">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                      <span class="text-danger fw-medium">
                        <i class="fas fa-exclamation-circle me-1"></i>Not Submitted
                      </span>
                      <span class="text-danger fw-bold">{{ pb.submitted_blank|floatformat:2 }}</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                      <span class="fw-bold">
                        <i class="fas fa-check-circle me-1"></i>Available
                      </span>
                      <span class="fs-5 fw-bold">{{ pb.available_balance|floatformat:2 }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
          {% else %}
          <div class="text-center py-5">
            <i class="fas fa-wallet fa-3x text-muted mb-3"></i>
            <h6 class="text-muted">No project balances available</h6>
            <p class="text-muted small">Click "Update Balance" to configure project balances</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card shadow-sm border-0 rounded-3 mb-4">
        <div class="card-body text-center p-4">
          <div class="avatar-circle bg-white text-primary mx-auto mb-3" style="width: 70px; height: 70px; font-size: 32px;">
            <i class="fas fa-users"></i>
          </div>
          <h5 class="fw-bold mb-2">Human Resource</h5>
          <p class="text-muted small">Manage all HR operations efficiently</p>
        </div>
      </div>

      <div class="card shadow-sm border-0 rounded-3">
        <div class="card-header bg-white border-0 py-3">
          <h6 class="mb-0 fw-semibold">
            <i class="fas fa-bolt text-warning me-2"></i>
            Quick Actions
          </h6>
        </div>
        <div class="card-body p-3">
          <div class="d-grid gap-2">
            <a href="{% url 'hr_staff' %}" class="btn btn-outline-primary rounded-pill">
              <i class="fas fa-user-tie me-2"></i>View Staff
            </a>
            <a href="{% url 'hr_leave' %}" class="btn btn-outline-success rounded-pill">
              <i class="fas fa-calendar-day me-2"></i>Leave Requests
            </a>
            <a href="{% url 'hr_hiring' %}" class="btn btn-outline-info rounded-pill">
              <i class="fas fa-user-plus me-2"></i>New Hiring
            </a>
            <a href="{% url 'hr_monthly_attendance' %}" class="btn btn-outline-warning rounded-pill">
              <i class="fas fa-calendar-check me-2"></i>Attendance
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endblock %}
  
  {% include 'humanresource/include/modals/updateBalancemodal.html' %}
</div>

<style>
.hover-primary:hover { color: #0d6efd !important; transition: color 0.3s ease; }
.nav-scroll { overflow-x: auto; -webkit-overflow-scrolling: touch; }
.nav-scroll::-webkit-scrollbar { height: 4px; }
.nav-scroll::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
.nav-scroll::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
.nav-scroll::-webkit-scrollbar-thumb:hover { background: #555; }
</style>

{% block extra_js %}
<script src="{% static 'humanresource/js/update_balance.js' %}"></script>
{% endblock %}

{% endblock %}